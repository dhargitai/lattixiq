# Story 6.1: Sticky CTA Implementation

## Status

Approved

## Story

**As a** user viewing premium benefits  
**I want** the subscription button to always be visible  
**So that** I can upgrade at any time without scrolling back down

## Acceptance Criteria

1. Subscribe CTA button remains fixed at bottom of modal
2. Button is always visible regardless of scroll position
3. Button maintains proper styling and functionality
4. Button remains accessible on all screen sizes
5. Button hover and click states work correctly
6. Button doesn't overlap with scrollable content

## Tasks / Subtasks

- [ ] Task 1: Restructure DialogContent layout for sticky footer pattern (AC: 1, 2, 6)
  - [ ] Create a flex container with scrollable content area and fixed footer
  - [ ] Ensure DialogContent uses flex column layout with proper height constraints
  - [ ] Add scroll container div for the benefits content
  - [ ] Position CTA button container as sticky footer
  - [ ] Test layout with both short and long content
- [ ] Task 2: Implement scrollable content area (AC: 2, 6)
  - [ ] Wrap markdown content in scrollable div with overflow-y-auto
  - [ ] Set max-height on content area to ensure footer remains visible
  - [ ] Add padding-bottom to content to prevent overlap with CTA
  - [ ] Ensure smooth scrolling behavior on all browsers
  - [ ] Test scroll behavior with varying content lengths
- [ ] Task 3: Style sticky CTA footer (AC: 1, 3, 5)
  - [ ] Add background color to footer matching modal background
  - [ ] Implement top border with subtle shadow for visual separation
  - [ ] Apply proper padding for button container
  - [ ] Ensure gradient button styling is preserved
  - [ ] Maintain hover and active states from existing implementation
- [ ] Task 4: Handle responsive design (AC: 4)
  - [ ] Test modal on mobile devices (320px - 768px)
  - [ ] Verify sticky footer works on tablet sizes (768px - 1024px)
  - [ ] Ensure proper behavior on desktop (1024px+)
  - [ ] Adjust modal max-height for different screen sizes
  - [ ] Test landscape orientation on mobile devices
- [ ] Task 5: Preserve existing functionality (AC: 3, 5)
  - [ ] Ensure checkout flow continues to work correctly
  - [ ] Maintain subscription sync functionality
  - [ ] Preserve loading states and error handling
  - [ ] Keep all existing button states (loading, disabled, etc.)
  - [ ] Verify dynamic content loading still works
- [ ] Task 6: Add visual polish (AC: 1, 3)
  - [ ] Add subtle box-shadow to sticky footer for elevation
  - [ ] Ensure smooth transitions when content changes
  - [ ] Test with different browser zoom levels
  - [ ] Verify accessibility with keyboard navigation
  - [ ] Check focus states are properly visible
- [ ] Task 7: Write tests for sticky CTA implementation
  - [ ] Unit test for component rendering with sticky footer
  - [ ] Test scroll behavior with long content
  - [ ] Test button visibility at different scroll positions
  - [ ] Test responsive behavior at different breakpoints
  - [ ] Integration test for checkout flow with new layout

## Dev Notes

### Previous Story Insights

No previous stories in Epic 6. This is the first story implementing the premium modal UX enhancements.

### Architecture Context

**Component Location:** [Source: architecture/10-unified-project-structure.md#29]

- Existing component: `/components/features/subscription/PremiumBenefitsDialog.tsx`
- Uses shadcn/ui Dialog components from `/components/ui/dialog.tsx`

**Tech Stack:** [Source: architecture/2-tech-stack.md]

- Frontend Framework: Next.js ~15.0.0
- UI Components: shadcn/ui ~2.0.0
- Styling: Tailwind CSS ~4.0.0
- TypeScript: ~5.5.3

**Component Structure Pattern:** [Source: architecture/8-frontend-architecture.md#20-61]

```tsx
// Standard component template with forwardRef pattern
const Component = React.forwardRef<HTMLDivElement, ComponentProps>(
  ({ className, ...props }, ref) => {
    return (
      <div className={cn("base-classes", className)} ref={ref} {...props}>
        {/* Component content */}
      </div>
    );
  }
);
```

**Current DialogContent Structure:** [Source: Read of PremiumBenefitsDialog.tsx]

- DialogContent has max-h-[80vh] and overflow-y-auto on the entire content
- CTA button is currently part of the scrollable content
- Uses gradient background and custom border styling

**CSS Implementation Strategy:**

```css
/* From epic technical details */
.premium-modal-container {
  display: flex;
  flex-direction: column;
  max-height: 80vh;
}

.scrollable-content {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
  margin-bottom: 0;
}

.sticky-cta-footer {
  position: sticky;
  bottom: 0;
  background: white; /* Will need to match modal gradient */
  padding: 1rem;
  border-top: 1px solid #e5e7eb;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
}
```

**Tailwind Utility Classes Equivalents:**

- Container: `flex flex-col max-h-[80vh]`
- Scrollable area: `flex-1 overflow-y-auto p-4 mb-0`
- Sticky footer: `sticky bottom-0 bg-white p-4 border-t border-gray-200 shadow-[0_-2px_10px_rgba(0,0,0,0.1)]`

**Styling Standards:** [Source: architecture/12-coding-standards.md#9-26]

- Use Tailwind CSS utilities for styling
- Component files use PascalCase: `PremiumBenefitsDialog.tsx`
- Functions and variables use camelCase
- Follow functional programming style (immutability, pure functions)

### Frontend Alignment Notes

**UI/UX Principles:** [Source: frontend-spec.md#11-14]

- Intentional Simplicity: Keep the modal clean with generous white space
- Celebrate Every Step: Subscription upgrade should feel rewarding
- Supportive Guidance: Language and interactions should be gentle, never demanding

**Modal Pattern:** Premium modal follows the "Serene Minimalist" aesthetic with:

- Clear, single primary action (Subscribe CTA)
- Non-overwhelming presentation of benefits
- Calming gradient background already implemented

### Testing Requirements

[Source: architecture/11-testing-strategy.md#15-22]

- Integration tests in `/tests/integration/` using Vitest and React Testing Library
- Test both happy and unhappy paths
- Focus on user interactions and real behavior
- Component rendering tests for layout changes
- E2E test for critical checkout flow

**Test Locations:**

- Unit tests: `/tests/unit/components/subscription/`
- Integration tests: `/tests/integration/subscription/`
- Existing test file: `/tests/unit/components/premium-dialog.test.tsx`

### Project Structure Notes

- Component already exists, only modification needed
- No new files required
- Follows established pattern in `/components/features/` directory
- Uses existing shadcn/ui Dialog components

## Change Log

| Date       | Version | Description                        | Author             |
| ---------- | ------- | ---------------------------------- | ------------------ |
| 2025-08-09 | 1.0     | Initial story creation from Epic 6 | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

[To be populated by dev agent]

### Debug Log References

[To be populated by dev agent]

### Completion Notes List

[To be populated by dev agent]

### File List

[To be populated by dev agent]

## QA Results

[To be populated by QA agent]
