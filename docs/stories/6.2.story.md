# Story 6.2: Notification Settings - MVP

## Status

Approved

## Story

**As a** user,
**I want** to control my notification settings
**so that** I receive reminders when I want them

## Acceptance Criteria

1. Master toggle for all notifications
2. Daily reminder time selector
3. Settings persist across sessions
4. Visual feedback on save
5. Match prototype toggle and time selector design

## Tasks / Subtasks

- [ ] Create notification settings UI (AC: 1, 2, 5)
  - [ ] Add notification section to settings page
  - [ ] Implement toggle switch using shadcn/ui Switch
  - [ ] Create time selector component
  - [ ] Match prototype styling exactly
- [ ] Implement toggle functionality (AC: 1)
  - [ ] Create state for notification enabled/disabled
  - [ ] Handle toggle state changes
  - [ ] Show/hide time selector based on toggle state
- [ ] Build time selector (AC: 2, 5)
  - [ ] Use shadcn/ui Select component
  - [ ] Populate with hourly time options (00:00 - 23:00)
  - [ ] Display in user-friendly format (12-hour with AM/PM)
  - [ ] Set default to 9:00 AM
- [ ] Add persistence logic (AC: 3)
  - [ ] Create API endpoint for saving preferences
  - [ ] Implement optimistic updates
  - [ ] Handle save errors gracefully
  - [ ] Load saved preferences on mount
- [ ] Implement visual feedback (AC: 4)
  - [ ] Add loading state during save
  - [ ] Show success toast on save
  - [ ] Display error message on failure
  - [ ] Use shadcn/ui Toast component
- [ ] Style to match prototype (AC: 5)
  - [ ] Toggle: 48x28px with green active state
  - [ ] Section header: uppercase "NOTIFICATIONS"
  - [ ] Proper spacing and card styling
  - [ ] Smooth animations on toggle
- [ ] Write tests (AC: 1, 2, 3)
  - [ ] Test toggle interaction
  - [ ] Test time selector functionality
  - [ ] Test persistence mocking
  - [ ] Test error handling

## Dev Notes

### Data Models

Notification preferences structure:

```typescript
interface UserPreferences {
  userId: string;
  notifications: {
    enabled: boolean;
    dailyReminderTime: string; // "HH:mm" format
  };
}
```

[Source: epic-6-settings-preferences.md#data-model]

### API Specifications

Endpoint for preferences (to be created):

- `PATCH /api/user/preferences`
- Request: `{ notifications: { enabled, dailyReminderTime } }`
- Response: Updated preferences object
  [Source: epic-6-settings-preferences.md#backend-requirements]

### Component Specifications

From prototype analysis:

- Toggle switch: 48x28px, #CBD5E0 off, #48BB78 on
- Slider animation: translateX(20px) when active
- Time selector: Dropdown/select component
- Help text: Italic, gray color (#718096)
  [Source: prototypes/settings.html#toggle-switch]

### File Locations

- Component: `/components/settings/NotificationSettings.tsx`
- API route: `/app/api/user/preferences/route.ts`
- Integrate into: `/app/(app)/settings/page.tsx`
  [Source: architecture/10-unified-project-structure.md]

### Testing Requirements

- Unit tests: `/tests/unit/settings/notification-settings.test.tsx`
- Mock API calls for testing
- Test toggle and time selector interactions
  [Source: architecture/12-coding-standards.md]

### Technical Constraints

- Use shadcn/ui Switch and Select components
- Implement optimistic UI updates
- Handle network failures gracefully
  [Source: architecture/2-tech-stack.md]

## Testing

### Testing Standards

- Test file: `/tests/unit/settings/notification-settings.test.tsx`
- Use Vitest with React Testing Library
- Mock API calls and localStorage
- Test all user interactions
  [Source: architecture/12-coding-standards.md#testing-standards]

## Change Log

| Date       | Version | Description                    | Author       |
| ---------- | ------- | ------------------------------ | ------------ |
| 2025-08-06 | 1.0     | Initial story creation         | Scrum Master |
| 2025-08-06 | 2.0     | Simplified to MVP requirements | Scrum Master |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_
