# Story 6.4: Logout Functionality - MVP

## Status

Approved

## Story

**As a** user,
**I want** to log out of my account
**so that** I can secure my session

## Acceptance Criteria

1. Clear logout button at bottom of settings
2. Red border styling per prototype
3. Confirms logout action
4. Redirects to login page after logout
5. Clears all session data

## Tasks / Subtasks

- [ ] Create logout button UI (AC: 1, 2)
  - [ ] Add button at bottom of settings page
  - [ ] Style with red border (#E53E3E)
  - [ ] White background, red text
  - [ ] Proper padding and border radius
- [ ] Implement logout confirmation (AC: 3)
  - [ ] Create confirmation dialog using shadcn/ui AlertDialog
  - [ ] Add warning message about logout
  - [ ] Implement confirm/cancel actions
  - [ ] Handle dialog state
- [ ] Add logout functionality (AC: 4, 5)
  - [ ] Call Supabase auth.signOut()
  - [ ] Clear local storage
  - [ ] Clear any cached data
  - [ ] Handle logout errors
- [ ] Implement redirect logic (AC: 4)
  - [ ] Redirect to /login after successful logout
  - [ ] Use Next.js router for navigation
  - [ ] Show loading state during logout
- [ ] Style to match prototype (AC: 2)
  - [ ] Button: 2px red border
  - [ ] Text: Red color (#E53E3E)
  - [ ] Padding: 14px 32px
  - [ ] Font: 16px, weight 600
  - [ ] Border radius: 10px
- [ ] Write tests (AC: 3, 4, 5)
  - [ ] Test button rendering
  - [ ] Test confirmation dialog
  - [ ] Test logout flow
  - [ ] Test session cleanup

## Dev Notes

### API Specifications

Supabase Auth logout:

```typescript
await supabase.auth.signOut();
```

[Source: architecture/2-tech-stack.md#authentication]

### Component Specifications

From prototype:

- Button position: Bottom of settings, with margin
- Button style: White background, red border (2px), red text
- Size: Full width on mobile, auto width on desktop
- Hover state: Slightly darker red
  [Source: prototypes/settings.html#logout-btn]

### File Locations

- Component: Part of `/app/(app)/settings/page.tsx`
- May extract to: `/components/settings/LogoutButton.tsx`
  [Source: architecture/10-unified-project-structure.md]

### Technical Constraints

- Use Supabase Auth for logout
- Ensure all client-side data is cleared
- Handle edge cases (network errors)
  [Source: architecture/2-tech-stack.md]

### Security Considerations

- Clear all session tokens
- Remove cached user data
- Ensure complete logout
  [Source: epic-6-settings-preferences.md#security-considerations]

## Testing

### Testing Standards

- Test file: `/tests/unit/settings/logout-button.test.tsx`
- Mock Supabase auth client
- Test confirmation flow
- Test cleanup operations
  [Source: architecture/12-coding-standards.md#testing-standards]

## Change Log

| Date       | Version | Description                | Author       |
| ---------- | ------- | -------------------------- | ------------ |
| 2025-08-06 | 1.0     | Initial MVP story creation | Scrum Master |

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent_

### Debug Log References

_To be filled by Dev Agent_

### Completion Notes List

_To be filled by Dev Agent_

### File List

_To be filled by Dev Agent_

## QA Results

_To be filled by QA Agent_
